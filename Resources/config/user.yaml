parameters:
    darvin_user.user.create_command.class: Darvin\UserBundle\Command\UserCreateCommand
    darvin_user.user.create_command.name:  darvin:user:create

    darvin_user.user.factory.class: Darvin\UserBundle\User\UserFactory

    darvin_user.user.form.factory.class: Darvin\UserBundle\Form\Factory\UserFormFactory

    darvin_user.user.form.handler.class: Darvin\UserBundle\Form\Handler\UserFormHandler

    darvin_user.user.form.renderer.class: Darvin\UserBundle\Form\Renderer\UserFormRenderer

    darvin_user.user.form.type.role.class: Darvin\UserBundle\Form\Type\User\RoleChoiceType

    darvin_user.user.manager.class: Darvin\UserBundle\User\UserManager

    darvin_user.user.repository.class: Darvin\UserBundle\Repository\UserRepository

    darvin_user.user.validator.user_exists_and_active.class: Darvin\UserBundle\Validator\UserExistsAndActiveValidator

services:
    _defaults:
        public: true

    darvin_user.user.create_command:
        class: '%darvin_user.user.create_command.class%'
        arguments:
            - '%darvin_user.user.create_command.name%'
            - '@doctrine.orm.entity_manager'
            - '@darvin_user.configuration.roles'
            - '@darvin_user.user.factory'
            - '@validator'
        tags:
            - { name: console.command }

    darvin_user.user.factory:
        class: '%darvin_user.user.factory.class%'
        arguments:
            - '%darvin_user.user_class%'

    darvin_user.user.form.factory:
        class: '%darvin_user.user.form.factory.class%'
        arguments:
            - '@form.factory'
            - '@router'
            - '@darvin_user.user.manager'
            - '%darvin_user.user_class%'

    darvin_user.user.form.handler:
        class: '%darvin_user.user.form.handler.class%'
        arguments:
            - '@doctrine.orm.entity_manager'
            - '@darvin_utils.flash.notifier'

    darvin_user.user.form.renderer:
        class: '%darvin_user.user.form.renderer.class%'
        arguments:
            - '@templating'
            - '@darvin_user.user.form.factory'

    darvin_user.user.form.type.role:
        class: '%darvin_user.user.form.type.role.class%'
        arguments:
            - '@darvin_user.configuration.roles'
        tags:
            - { name: form.type }

    darvin_user.user.manager:
        class: '%darvin_user.user.manager.class%'
        arguments:
            - '@security.token_storage'
            - '@security.password_encoder'

    darvin_user.user.repository:
        alias: '%darvin_user.user.repository.class%'

    '%darvin_user.user.repository.class%':
        class:  '%darvin_user.user.repository.class%'
        public: false
        arguments:
            - '@doctrine'
            - '%darvin_user.user_class%'
        tags:
            - { name: doctrine.repository_service }

    darvin_user.user.validator.user_exists_and_active:
        class: '%darvin_user.user.validator.user_exists_and_active.class%'
        arguments:
            - '@darvin_user.user.repository'
        tags:
            - { name: validator.constraint_validator, alias: darvin_user_user_exists_and_active }
